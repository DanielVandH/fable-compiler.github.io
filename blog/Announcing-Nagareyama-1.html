<html><head><title>Fable Blog</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="twitter:title" content="Fable"/><meta name="twitter:description" content="F# to JS compiler"/><meta name="twitter:image" content="https://fable.io/img/fable_logo.png"/><meta name="twitter:card" content="summary_large_image"/><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Josefin+Sans:400,300,600,700|Roboto+Mono|Fira+Code|Open+Sans:400,300,600,700"/><script src="https://kit.fontawesome.com/f1c8a90b9d.js"></script><link rel="stylesheet" type="text/css" href="/css/styles.css"/><link rel="stylesheet" type="text/css" href="/css/prism.css"/><link rel="shortcut icon" href="/img/fable.ico"/></head><body><nav class="navbar"><div class="navbar-brand"><a class="navbar-item is-size-4" href="/" style="background-color:rgba(0,0,0,0.5);color:dodgerblue;font-weight:600">Fable</a><div class="navbar-burger" data-target="navMenu"><span></span><span></span><span></span></div></div><div id="navMenu" class=" navbar-menu"><div class="navbar-start"><a class=" navbar-item" href="/docs">Docs</a><a class=" navbar-item is-active" href="/blog">Blog</a><a class=" navbar-item" href="/repl">REPL</a><a class=" navbar-item" href="/community">Community</a><a class=" navbar-item" href="/fableconf">FableConf</a></div><div class="navbar-end"><div class="field is-grouped"><a class="navbar-item" href="https://gitter.im/fable-compiler/Fable" target="_blank" style="color:white"><span class="icon"><i class=" fab fa-gitter"></i></span></a><a class="navbar-item" href="https://github.com/fable-compiler/fable" target="_blank" style="color:white"><span class="icon"><i class=" fab fa-github"></i></span></a><a class="navbar-item" href="https://twitter.com/FableCompiler" target="_blank" style="color:white"><span class="icon"><i class=" fab fa-twitter"></i></span></a><a class="navbar-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos" target="_blank" style="color:white"><span class="icon"><i class=" fab fa-youtube"></i></span></a></div></div></div></nav><div class="markdown blog" style="overflow:hidden"><div class="fable-header-minimal"><figure class="image" style="max-width:200px;margin:20px auto"><img class="fable-logo" src="/img/fable_logo.png"/></figure></div><div style="margin-top:1.6rem"><div class="columns"><div class="column"></div><div class="column is-two-thirds"><div class="post_date" style="margin:5px;margin-bottom:2em"><i class=" far fa-calendar"></i> October 23, 2020</div><div class="content" style="margin:5px"><p>Next-gen Fable is here! This is the first of a series of posts to introduce the improvements this new major release brings. We will start with the biggest change: Fable will now be distribute as a <a href="https://docs.microsoft.com/en-us/dotnet/core/tools/global-tools">dotnet tool</a>. Keep reading to learn the reasoning behind this and what improvements are happening with the change.</p>
<h2><a name="fable-as-a-dotnet-tool" class="anchor" href="#fable-as-a-dotnet-tool">Fable as a dotnet tool</a></h2><p>It looks like ages now, but Fable 2 was originally distributed as a dotnet tool. We had many troubles though, because at the time it was not possible to pin the version per repository. Also, as the main way to use Fable was through <code>fable-loader</code> (a Webpack plugin) we decided to distribute the compiler itself through npm too: the <a href="https://www.npmjs.com/package/fable-compiler">fable-compiler</a> package.</p>
<p>I really love npm for package distribution. You can put anything you want in there, it&#39;s very fast to list new versions and testing local development packages is quite easy. But now the dotnet team has finally fixed the problem with version-pinning and given that most of F# tools (Fake, Paket, Femto, Fantomas...) are integrating with the dotnet sdk, it makes sense for us to follow the same path. This reduces the cognitive load for the user as you can remain within the dotnet ecosystem while working in F# and move to JS with the files that have been already generated.</p>
<p>These are the guidelines we&#39;ve followed while porting Fable as a dotnet tool:</p>
<ul>
<li><strong>Similar experience to dotnet SDK</strong>: So you write <code>dotnet fable src</code> to compile a project in the <code>src</code> folder, and <code>dotnet fable watch src</code> to run Fable in watch mode.</li>
<li><strong>No focus on a specific JS tool</strong>: As we just output JS files, you can process them with any tool you want.</li>
<li><strong>No config files</strong>: I&#39;m sure you already have to deal with a bunch of them in your daily work!</li>
</ul>
<h2><a name="fable-as-a-quot-pure-quot-dotnet-app" class="anchor" href="#fable-as-a-quot-pure-quot-dotnet-app">Fable as a &quot;pure&quot; dotnet app</a></h2><p>The problem with version pinning was not the only reason to distribute Fable through npm. Fable itself was (in part) a JS application with JS dependencies, specifically <a href="https://babeljs.io/">Babel</a>.</p>
<p>Babel made Fable possible, and the name will always be a tribute to the Babel team. It was not only a source of inspiration (I was using Babel at work for several months before starting writing Fable), but when the very first version of Fable appeared &quot;modern&quot; JS was still not widely supported and there were several competing standards for the &quot;module&quot; system. Thanks to Babel we didn&#39;t have to worry about this, users were free to choose the kind of JS they wanted to generate and we could focus on the F# transformation. Nowadays, luckily the &quot;import/export&quot; module and modern syntax is supported by most browsers, so we can be sure the code we generate is compatible with most environments and tooling.</p>
<p>BTW, if you do need Babel in your workflow to transform the generated code to a version of JS that is supported in older browsers, it&#39;s absolutely fine. If you&#39;re using Webpack just keep the <code>babel-loader</code> in place and you&#39;re done!</p>
<h2><a name="speed-improvements" class="anchor" href="#speed-improvements">Speed improvements</a></h2><p>Removing the JS process means we don&#39;t need the inter-process communication any more, which makes Fable faster. What I didn&#39;t expect is it would make it so much faster! We will see the improvements in more detail in a later post, but just as an appetizer behold this benchmark that shows how the compilation time for Fable tests has been cut almost in half!</p>
<p><img src="/img/blog/benchmark1.jpg" alt="Benchmark"></p>
<h2><a name="try-it-out-" class="anchor" href="#try-it-out-">Try it out!</a></h2><p>&quot;Talk is cheap, show me the code.&quot; I hear you. We&#39;ve uploaded a minimal sample so you can start playing with Nagareyama, that you can find <a href="https://github.com/fable-compiler/fable3-samples/tree/main/minimal">here</a>. Just to show you how easy is to use the new Fable with other tools, this example uses <a href="https://parceljs.org/">Parcel</a>, an alternative to Webpack that promotes itself as being config-less and faster.</p>
<p>If you want to try upgrading your Webpack app (we&#39;re aiming at not having code breaking changes, so hopefully everything just works), please check <a href="https://github.com/MangelMaxime/fulma-demo/pull/43">this PR</a> to learn the few steps you need to make your build Nagaremaya-ready.</p>
<br />

<p>I hope you enjoyed the post. Just remember we&#39;re still in beta phase: we will try not to make big changes but a few one may still be on the road, particularly for new features like plugins... but this belongs to the next posts :)</p>
<p>Have fun!</p>
</div></div><div class="column"></div></div></div></div><footer style="background-color:dodgerblue"><div class="content"><p>Fable <a href="https://github.com/fable-compiler/Fable">source code</a> is licensed <a href="http://opensource.org/licenses/mit-license.php">MIT</a>.</p></div></footer><script>
document.addEventListener('DOMContentLoaded', function () {
  // burger
  var $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
  if ($navbarBurgers.length > 0) {
    $navbarBurgers.forEach(function ($el) {
      $el.addEventListener('click', function () {
        var target = $el.dataset.target;
        var $target = document.getElementById(target);
        $el.classList.toggle('is-active');
        $target.classList.toggle('is-active');
      });
    });
  }
});</script></body></html>